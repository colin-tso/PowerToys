<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define RegistryPreviewAssetsFiles=data32.png;deleted-folder32.png;deleted-value32.png;error32.png;folder32.png;index.html;RegistryPreview.ico;string32.pngdata32.png;deleted-folder32.png;deleted-value32.png;error32.png;folder32.png;index.html;RegistryPreview.ico;string32.pngdata32.png;deleted-folder32.png;deleted-value32.png;error32.png;folder32.png;index.html;RegistryPreview.ico;string32.pngdata32.png;deleted-folder32.png;deleted-value32.png;error32.png;folder32.png;index.html;RegistryPreview.ico;string32.pngdata32.png;deleted-folder32.png;deleted-value32.png;error32.png;folder32.png;index.html;RegistryPreview.ico;string32.png?>
  <?define RegistryPreviewAssetsFilesPath=$(var.BinDir)WinUI3Apps\Assets\RegistryPreview?>

  <Fragment>
    <!-- Registry Preview -->
    <DirectoryRef Id="WinUI3AppsAssetsFolder">
      <Directory Id="RegistryPreviewAssetsInstallFolder" Name="RegistryPreview" />
    </DirectoryRef>
    <DirectoryRef Id="RegistryPreviewAssetsInstallFolder" FileSource="$(var.RegistryPreviewAssetsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->

            <Component Id="RegistryPreviewAssetsFiles_Component" Win64="yes" Guid="9B3A57AD-8949-4F6A-B51F-EBB7110545D5">
              <RegistryKey Root="HKLM" Key="Software\Classes\powertoys\components">
                <RegistryValue Type="string" Name="RegistryPreviewAssetsFiles_Component" Value="" KeyPath="yes"/>
              </RegistryKey>
              <File Id="RegistryPreviewAssetsFiles_File_data32.png" Source="$(var.RegistryPreviewAssetsFilesPath)\data32.png" />
              <File Id="RegistryPreviewAssetsFiles_File_deleted_folder32.png" Source="$(var.RegistryPreviewAssetsFilesPath)\deleted-folder32.png" />
              <File Id="RegistryPreviewAssetsFiles_File_deleted_value32.png" Source="$(var.RegistryPreviewAssetsFilesPath)\deleted-value32.png" />
              <File Id="RegistryPreviewAssetsFiles_File_error32.png" Source="$(var.RegistryPreviewAssetsFilesPath)\error32.png" />
              <File Id="RegistryPreviewAssetsFiles_File_folder32.png" Source="$(var.RegistryPreviewAssetsFilesPath)\folder32.png" />
              <File Id="RegistryPreviewAssetsFiles_File_index.html" Source="$(var.RegistryPreviewAssetsFilesPath)\index.html" />
              <File Id="RegistryPreviewAssetsFiles_File_RegistryPreview.ico" Source="$(var.RegistryPreviewAssetsFilesPath)\RegistryPreview.ico" />
              <File Id="RegistryPreviewAssetsFiles_File_string32.png" Source="$(var.RegistryPreviewAssetsFilesPath)\string32.png" />
            </Component>

    </DirectoryRef>

    <ComponentGroup Id="RegistryPreviewComponentGroup">
      <Component Id="RemoveRegistryPreviewFolder" Guid="D3DBC395-FAC5-44B1-BE44-3FE2B6E0F391" Directory="RegistryPreviewAssetsInstallFolder" >
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="RemoveRegistryPreviewFolder" Value="" KeyPath="yes"/>
        </RegistryKey>
        <RemoveFolder Id="RemoveFolderRegistryPreviewAssetsFolder" Directory="RegistryPreviewAssetsInstallFolder" On="uninstall"/>
      </Component>
            <ComponentRef Id="RegistryPreviewAssetsFiles_Component" />
            <ComponentRef Id="RegistryPreviewAssetsFiles_Component" />
            <ComponentRef Id="RegistryPreviewAssetsFiles_Component" />
            <ComponentRef Id="RegistryPreviewAssetsFiles_Component" />
            <ComponentRef Id="RegistryPreviewAssetsFiles_Component" />
    </ComponentGroup>

  </Fragment>
</Wix>
